package ejbholidaybookingapp;

import javax.ejb.LocalBean;
import javax.ejb.Stateless;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;

import entityclasses.DepartmentDTO;
import entityclasses.EmployeeRoleDTO;
import model.TDepartment;
import model.TEmployeeRole;

@Stateless
@LocalBean
public class EmployeeRoleAppBean implements EmployeeRoleAppBeanRemote {

	@PersistenceContext
	EntityManager entityManager;

    public EmployeeRoleAppBean() {
    }

	@Override
	public EmployeeRoleDTO getRoleByUpperRoleName(String upperName) {
		TEmployeeRole empRole = (TEmployeeRole) entityManager
				.createQuery("SELECT e FROM TEmployeeRole e WHERE e.Dep = :name")
				.setParameter("name", upperName).getResultList().get(0);
		EmployeeRoleDTO empRoleDTO = new EmployeeRoleDTO(
				empRole.getIdEmpRole(), empRole.getNameEmpRole(), empRole.getNameEmpRoleUpper(), empRole.getCanApprove()
			);
		return empRoleDTO;
	}

	@Override
	public EmployeeRoleDTO getDeputyHeadRole(String upperName) {
		TDepartment department = (TDepartment) entityManager
				.createQuery("SELECT e FROM TDepartment e WHERE e.Dep = :id")
				.setParameter("id", id).getResultList().get(0);
		DepartmentDTO departmentDTO = new DepartmentDTO(
					department.getIdDep(), department.getNameDep(), department.getNameDepUpper(), department.getMaxNPeople()
				);
		return false;
	}

}
